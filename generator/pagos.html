<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Pago en Cripto | PlataformA</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js"></script>
  <link rel="stylesheet" href="styles.css">
  <style>
    .generator-box {
      box-sizing: border-box;
      padding-bottom: 22px;
    }
    .logo-top {
      margin: 0 auto 13px auto;
      text-align: center;
    }
    .logo-top img {
      width: 72px;
      height: 72px;
      object-fit: cover; /* Это обеспечит заполнение всего поля */
      border-radius: 14px;
      display: block;
      margin: 0 auto;
     box-shadow: 0 2px 16px 0 #c6d0e1a0;
     background: #fff;
    }

    .mini-title {
      text-align: center;
      font-size: 1.05rem;
      font-weight: 600;
      color: #5f6d85;
      margin-bottom: 13px;
      letter-spacing: 0.01em;
    }
    .info-banner {
      background: #f4f7fd;
      color: #38485c;
      border-radius: 8px;
      margin: 15px auto 5px auto;
      text-align: center;
      padding: 8px 12px 7px 12px;
      font-size: 1.07rem;
      border: 1px solid #e0eafc;
      max-width: 98%;
      box-shadow: 0 1px 4px 0 #e2e8f070;
      font-weight: 500;
    }
    @media (max-width: 540px) {
      .info-banner { font-size: 0.99rem; padding: 7px 2px; }
      .mini-title { font-size: 0.98rem; }
      .logo-top img { width: 60px; height: 60px; }
    }
  </style>
</head>
<body>
  <div class="main-wrap-gen">
    <div class="generator-box" id="pagoBox">
      <div class="logo-top" id="logoBox"></div>
      <div class="mini-title">Datos para tu pago</div>
      <div id="detallePago"></div>
      <div id="qrPagoBox"></div>
    </div>
  </div>
  <script>
    function getID() {
      const params = new URLSearchParams(window.location.search);
      return params.get('id');
    }
    const id = getID();
    const datos = JSON.parse(localStorage.getItem('plataforma_pago_' + id));
    if (!datos) {
      document.getElementById('pagoBox').innerHTML = '<h2>No se encontró el pago</h2>';
    } else {
      // Логотип
      if (datos.logoBase64) {
        document.getElementById('logoBox').innerHTML = `<img src="${datos.logoBase64}">`;
      } else {
        // Фолбек если нет логотипа (можешь заменить на свой или оставить пустым)
        document.getElementById('logoBox').innerHTML = `<img src="assets/logo.png">`;
      }
      // Детали платежа
      document.getElementById('detallePago').innerHTML = `
        <div style="font-weight:700;font-size:1.13rem;margin-bottom:8px;">${datos.nombre}</div>
        <div style="font-size:1.01rem;margin-bottom:7px;">${datos.descripcion}</div>
        <div style="font-size:1.1rem;margin-bottom:7px;">Criptomoneda: <b>${datos.crypto}</b></div>
        ${datos.monto ? `<div style="font-size:1.1rem;margin-bottom:10px;">Monto: <b>${datos.monto} ${datos.crypto}</b></div>` : ''}
      `;
      // QR-код, адрес и баннер
      document.getElementById('qrPagoBox').innerHTML = `
        <canvas id="qrPago" style="display:block;margin:18px auto;"></canvas>
        <div style="text-align:center;margin-bottom:3px;">
          <input type="text" id="direccionCopia" readonly style="width:80%;font-size:1rem;margin-bottom:7px;">
          <button onclick="copiarDireccion()" class="mini-btn" style="margin-left:7px;">Copiar dirección</button>
        </div>
        <div class="info-banner">
          Elegí la moneda <b>USDT</b> y la red <b>Polygon (POS)</b> en tu billetera.<br>
          
          Luego, escaneá el QR o copiá la dirección para pagar.
        </div>
      `;
      // QR
      new QRious({
        element: document.getElementById('qrPago'),
        value: datos.wallet,
        size: 180
      });
      document.getElementById('direccionCopia').value = datos.wallet;
    }
    function copiarDireccion() {
      document.getElementById('direccionCopia').select();
      document.execCommand('copy');
      alert('Dirección copiada');
    }
  </script>
</body>
</html>
